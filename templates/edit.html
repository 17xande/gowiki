{{define "head"}}
  <title>SCMS|Edit {{.document.Title}}</title>
  <link rel="stylesheet" href="/public/dependencies/css/quill.snow.css">
{{end}}

{{define "body"}}
<form id="frmContent" action="/save/{{.document.ID.Hex}}" method="POST">
  <h1>Editing <input id="txtTitle" name="title" type="text" value="{{.document.Title}}"></h1>
  <div id="divQuill">{{.body}}</div>
  <input id="hdnBody" type="hidden" name="body">
  <input id="btnSave" type="submit" value="Save">
  <button id="btnCancel">Cancel</button>
  <div>
    <h3>Permissions:</h3>
    <label for="numLevel">Level:</label>
    <input id="numLevel" name="level" type="number" value="{{.document.Level}}">
  </div>
  <h4>User Override:</h4>
  <select name="users" id="slcUsers">
    {{range $index, $user := .users}}
    <option value="{{$user.ID.Hex}}">{{$user.Name}}</option>
    {{end}}
  </select>
</form>
{{end}}

{{define "scripts"}}
  <script src="/public/dependencies/js/quill.min.js"></script>
  <script>
    let quill = new Quill('#divQuill', {
      placeholder: "Enter text here",
      theme: 'snow'
    });

    let hdnBody = document.getElementById("hdnBody");
    let btnCancel = document.getElementById("btnCancel");
    let id = window.location.pathname.slice(window.location.pathname.lastIndexOf('/'));

    // redirect to the view page
    btnCancel.addEventListener('click', function(event) {
      if (id == "/") {
        window.location.href = "/";
      } else {        
        window.location.href = "/view" + id;
      }
      return false
    }, false);
  </script>
{{end}}